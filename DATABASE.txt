-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.exercise_blocks (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  session_id uuid,
  block_number integer NOT NULL,
  name text,
  rest_after_block_s integer,
  notes text,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT exercise_blocks_pkey PRIMARY KEY (id),
  CONSTRAINT exercise_blocks_session_id_fkey FOREIGN KEY (session_id) REFERENCES public.training_sessions(id)
);
CREATE TABLE public.exercise_results (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  exercise_id uuid,
  set_number integer,
  repetition_number integer,
  time_s numeric,
  weight_kg numeric,
  rpe numeric CHECK (rpe >= 0::numeric AND rpe <= 10::numeric),
  notes text,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT exercise_results_pkey PRIMARY KEY (id),
  CONSTRAINT exercise_results_exercise_id_fkey FOREIGN KEY (exercise_id) REFERENCES public.exercises(id)
);
CREATE TABLE public.exercises (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  name text NOT NULL,
  discipline_type text CHECK (discipline_type = ANY (ARRAY['accelerazioni'::text, 'partenze'::text, 'allunghi'::text, 'resistenza'::text, 'tecnica'::text, 'mobilitÃ '::text])),
  distance_m integer,
  sets integer DEFAULT 1,
  repetitions integer DEFAULT 1,
  rest_between_reps_s integer,
  rest_between_sets_s integer,
  intensity numeric CHECK (intensity >= 0::numeric AND intensity <= 10::numeric),
  effort_type text CHECK (effort_type = ANY (ARRAY['basso'::text, 'medio'::text, 'alto'::text, 'massimo'::text])),
  notes text,
  created_at timestamp with time zone DEFAULT now(),
  block_id uuid NOT NULL,
  exercise_number integer NOT NULL,
  CONSTRAINT exercises_pkey PRIMARY KEY (id),
  CONSTRAINT exercises_block_id_fkey FOREIGN KEY (block_id) REFERENCES public.exercise_blocks(id)
);
CREATE TABLE public.metrics (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  session_id uuid,
  date date NOT NULL,
  metric_name text NOT NULL,
  category text CHECK (category = ANY (ARRAY['gara'::text, 'test'::text, 'massimale'::text])),
  metric_target text,
  value numeric,
  unit text,
  distance_m integer,
  time_s numeric,
  recovery_post_s integer,
  intensity numeric CHECK (intensity >= 0::numeric AND intensity <= 10::numeric),
  notes text,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT metrics_pkey PRIMARY KEY (id),
  CONSTRAINT metrics_session_id_fkey FOREIGN KEY (session_id) REFERENCES public.training_sessions(id)
);
CREATE TABLE public.training_blocks (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  name text NOT NULL,
  start_date date NOT NULL,
  end_date date NOT NULL,
  goal text,
  notes text,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT training_blocks_pkey PRIMARY KEY (id)
);
CREATE TABLE public.training_sessions (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  block_id uuid,
  date date NOT NULL,
  type text CHECK (type = ANY (ARRAY['pista'::text, 'palestra'::text, 'test'::text, 'gara'::text, 'scarico'::text, 'recupero'::text, 'altro'::text])),
  title text,
  location text,
  phase text,
  notes text,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT training_sessions_pkey PRIMARY KEY (id),
  CONSTRAINT training_sessions_block_id_fkey FOREIGN KEY (block_id) REFERENCES public.training_blocks(id)
);
